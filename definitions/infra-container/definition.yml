domain: INFRA
type: CONTAINER

synthesis:
  rules:
  # We use a composite identifier to avoid potential collisions when the entity is generated from two different systems.
  # This approach ensures that the entity's uniqueness is preserved, whether it is generated by the infra platform+entity
  # lib indexer (docker, k8s) or the entity synthesis indexer (OTel).
  - compositeIdentifier:
      separator: ":"
      attributes:
        - instrumentation.provider
        - container.id
    name: container.name
    encodeIdentifierInGUID: true
    # This is a temporary condition to restrict synthesis for a particular set of telemetry data.
    conditions:
      - attribute: nr.entity_type
        value: container
    tags:
      container.runtime:
      container.image.name:
      container.image.tag:
      container.hostname:
      container.image.id:
      # This tag is not currently used by OTel docker stats receiver.
      container.state:
      host.type:
      cloud.provider:
      cloud.account.id:
      cloud.region:
  tags:
    newrelic.integrationName:
    newrelic.integrationVersion:
    newrelic.agentVersion:
    host.instanceType:
    # For OpenTelemetry
    telemetry.sdk.name:
      entityTagName: instrumentation.provider
    telemetry.sdk.language:
      entityTagName: language
    # AWS tags
    aws.region:

goldenTags:
- environment
- container.state

configuration:
  entityExpirationTime: FOUR_HOURS
  alertable: true
