cpuUsage:
  title: CPU usage (cores)
  queries:
    newRelic:
      select: max(docker.container.cpuUsedCores) or max(k8s.container.cpuUsedCores) as 'CPU used cores'
    opentelemetry:
      # Defaulting to the New Relic query for now since value functions for OpenTelemetry cumulative metrics cannot be matched reliably in golden_metrics.yml.
      # See: https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/dockerstatsreceiver/metadata.yaml
      # Note: CPU limit (container.cpu.limit) is emitted, but cannot be reliably queried in golden_metrics.yml due to NRQL limitations.
      select: rate(sum(container.cpu.usage.total)/1E9, 1 second) AS 'CPU usage (cores)'
cpuUtilization:
  title: CPU utilization (%)
  unit: PERCENTAGE
  queries:
    newRelic:
      select: max(docker.container.cpuPercent) or max(k8s.container.cpuCoresUtilization) AS 'CPU Utilization (%)'
    opentelemetry:
      # via dockerstatsreceiver & kubeletstatsreceiver â€“ which send equivalent value named container.cpu.usage, container.cpu.utilization (deprecated)
      select: max(container.cpu.usage or container.cpu.utilization) AS 'CPU Utilization (%)'
memoryUsage:
  title: Memory usage (bytes)
  unit: BYTES
  queries:
    newRelic:
      select: max(docker.container.memoryUsageBytes) or max(docker.container.memoryPrivateWorkingSet) or max(k8s.container.memoryWorkingSetBytes) AS 'Memory used (bytes)'
    opentelemetry:
      # via dockerstatsreceiver OR kubeletstatsreceiver respectively
      select: max(container.memory.usage.total) or max(container.memory.usage) AS 'Memory used (bytes)'
storageUsage:
  title: Storage usage (bytes)
  unit: BYTES
  queries:
    newRelic:
      select: max(docker.container.ioTotalBytes) or max(k8s.container.fsUsedPercent) AS 'Storage used (bytes)'
    opentelemetry:
      # via dockerstatsreceiver OR kubeletstatsreceiver respectively
      select: max(container.blockio.io_service_bytes_recursive) or max(container.filesystem.usage) AS 'Storage used (bytes)'
networkTrafficTotal:
  title: Network traffic (bytes per second)
  unit: BYTES_PER_SECOND
  queries:
    newRelic:
      select: max(docker.container.networkRxBytesPerSecond) + max(docker.container.networkTxBytesPerSecond) AS 'Network traffic (bytes per second)'
    opentelemetry:
  select: rate(sum(container.network.io.usage.rx_bytes), 1 second) + rate(sum(container.network.io.usage.tx_bytes), 1 second) AS 'Network traffic (bytes per second)'
