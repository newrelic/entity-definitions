{
  "name": "Calico Metrics Dashboard",
  "description": "A dashboard for monitoring Calico metrics from Prometheus.",
  "pages":
    [
      {
        "name": "Calico Overview",
        "description": null,
        "widgets":
          [
            {
              "title": "",
              "layout": { "column": 1, "row": 1, "width": 2, "height": 3 },
              "visualization": { "id": "viz.markdown" },
              "rawConfiguration":
                {
                  "text": "![Calico Logo](https://raw.githubusercontent.com/tigera/docs/refs/heads/main/static/img/calico-logo.svg)\n\n# Calico Dashboard\n\nMetrics for the Calico networking and security solution.\n\nDashboard filtered by `prometheus_server` and `instance`."
                }
            },
            {
              "title": "Number of Calico Hosts",
              "layout": { "column": 3, "row": 1, "width": 3, "height": 3 },
              "visualization": { "id": "viz.billboard" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_cluster_num_hosts) AS 'Number of Calico Hosts' FROM Metric WHERE instrumentation.name = 'remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET prometheus_server"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Cluster Workload Endpoints",
              "layout": { "column": 6, "row": 1, "width": 3, "height": 3 },
              "visualization": { "id": "viz.billboard" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_cluster_num_workload_endpoints) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Cluster Host Endpoints",
              "layout": { "column": 9, "row": 1, "width": 4, "height": 3 },
              "visualization": { "id": "viz.billboard" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_cluster_num_host_endpoints) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active Policies",
              "layout": { "column": 1, "row": 4, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_active_local_policies) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active IP Sets",
              "layout": { "column": 7, "row": 4, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_ipsets_calico) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active Local Endpoints",
              "layout": { "column": 1, "row": 8, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_active_local_endpoints) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active Local Selectors",
              "layout": { "column": 7, "row": 8, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_active_local_selectors) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Dataplane Failed Updates",
              "layout": { "column": 1, "row": 12, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(felix_int_dataplane_failures) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "IP Set Command Failures",
              "layout": { "column": 7, "row": 12, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(felix_ipset_errors) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Felix Resyncing Datastore",
              "layout": { "column": 1, "row": 16, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(felix_resyncs_started) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Cluster Wide Policies",
              "layout": { "column": 7, "row": 16, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "FROM Metric Select latest(felix_cluster_num_policies) WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active IP Table Chains by Type",
              "layout": { "column": 1, "row": 20, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_iptables_chains) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active IP Table Chains by Instance, IP Version",
              "layout": { "column": 7, "row": 20, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(chains) FROM ( FROM Metric SELECT latest(felix_iptables_chains) AS 'chains' FACET prometheus_server, instance, ip_version, table WHERE instrumentation.name= 'remote-write' AND prometheus_server IN ( {{ prometheus_server }} ) AND instance IN ( '{{tags.instance}}' ) AND  LIMIT MAX ) facet concat(prometheus_server,' - ',instance) , concat('ip_version: ',ip_version)"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "IP Tables Restore Errors",
              "layout": { "column": 1, "row": 24, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(felix_iptables_restore_errors) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "IP Tables Save Errors",
              "layout": { "column": 7, "row": 24, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT sum(felix_iptables_save_errors) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Active IP Tables Rules by Type",
              "layout": { "column": 1, "row": 28, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_iptables_rules) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance),table TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Calico BPF",
              "layout": { "column": 7, "row": 28, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_bpf_dataplane_endpoints) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "Failed BPF Endpoints",
              "layout": { "column": 1, "row": 32, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_bpf_dirty_dataplane_endpoints) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            },
            {
              "title": "BPF IPsets",
              "layout": { "column": 7, "row": 32, "width": 6, "height": 4 },
              "visualization": { "id": "viz.line" },
              "rawConfiguration":
                {
                  "nrqlQueries":
                    [
                      {
                        "accountId": 0,
                        "query": "SELECT latest(felix_bpf_num_ip_sets) FROM Metric WHERE instrumentation.name='remote-write' AND prometheus_server IN ( '{{tags.prometheus_server}}') AND instance IN ( '{{tags.instance}}' ) FACET concat(prometheus_server,' - ',instance) TIMESERIES"
                      }
                    ],
                  "yAxisLeft": { "zero": true }
                }
            }
          ]
      }
    ]
}
