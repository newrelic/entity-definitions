brokerCount:
  title: Brokers
  unit: COUNT
  queries:
    newRelic:
      select: latest(cluster.activeBrokerCount)
      from: KafkaClusterSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: latest(kafka.brokers)
      from: Metric
      where: metricName='kafka.brokers'
      eventId: entity.guid

TopicCount:
  title: Topics
  unit: COUNT
  queries:
    newRelic:
      select: latest(cluster.globalTopicCount)
      from: KafkaClusterSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: latest(kafka.cluster.topic.count)
      from: Metric
      where: metricName='kafka.cluster.topic.count' and getField(kafka.cluster.topic.count , 'count') > 0
      eventId: entity.guid

partitionCount:
  title: Partitions
  unit: COUNT
  queries:
    newRelic:
      select: latest(cluster.globalPartitionCount)
      from: KafkaClusterSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: latest(kafka.cluster.partition.count)
      from: Metric
      where: metricName='kafka.cluster.partition.count' and getField(kafka.cluster.partition.count , 'count') > 0
      eventId: entity.guid

offlinePartitions:
  title: Offline partitions
  unit: COUNT
  queries:
    newRelic:
      select: max(cluster.offlinePartitionsCount)
      from: KafkaClusterSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: max(kafka.partition.offline)
      from: Metric
      where: metricName='kafka.partition.offline'
      eventId: entity.guid