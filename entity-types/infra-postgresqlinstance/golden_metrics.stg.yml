scheduledCheckpoints:
  title: Scheduled checkpoints
  unit: OPERATIONS_PER_SECOND
  queries:
    newRelic:
      select: average(bgwriter.checkpointsScheduledPerSecond) as scheduled_checkpoints
      from: PostgresqlInstanceSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: rate(sum(postgresql.bgwriter.checkpoint.count), 1 second) as scheduled_checkpoints
      from: Metric
      where: type = 'scheduled'
      

requestedCheckpoints:
  title: Requested checkpoints
  unit: OPERATIONS_PER_SECOND
  queries:
    newRelic:
      select: average(bgwriter.checkpointsRequestedPerSecond) as requested_checkpoints
      from: PostgresqlInstanceSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: rate(sum(postgresql.bgwriter.checkpoint.count), 1 second) as requested_checkpoints
      from: Metric
      where: type = 'requested'

buffersAllocated:
  title: Buffers allocated
  unit: OPERATIONS_PER_SECOND
  queries:
    newRelic:
      select: average(bgwriter.buffersAllocatedPerSecond) as buffers_allocated
      from: PostgresqlInstanceSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: rate(sum(postgresql.bgwriter.buffers.allocated), 1 second) as buffers_allocated
      from: Metric

connectionActive:
  title: Active connections
  unit: COUNT
  queries:
    opentelemetry:
      select: latest(postgresql.backends) as active_connections
      from: Metric

