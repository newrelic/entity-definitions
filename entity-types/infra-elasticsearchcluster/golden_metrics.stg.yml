clusterHealth:
  title: Cluster Health
  queries:
    opentelemetry:
      select: latest(elasticsearch.cluster.health)
      from: Metric
      where: metricName = 'elasticsearch.cluster.health'
      facet: status
      eventId: entity.guid
      eventName: entity.name
    newRelic:
      select: latest(cluster.status)
      from: ElasticsearchClusterSample
      eventId: entityGuid
      eventName: entityName
clusterDataNode:
  title: Cluster Data Node
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.data_nodes)
      from: Metric
      where: metricName = 'elasticsearch.cluster.data_nodes'
      eventId: entity.guid
      eventName: entity.name
    newRelic:
      select: average(cluster.dataNodes)
      from: ElasticsearchClusterSample
      eventId: entityGuid
      eventName: entityName
clusterNode:
  title: Cluster Node
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.nodes)
      from: Metric
      where: metricName = 'elasticsearch.cluster.nodes'
      eventId: entity.guid
      eventName: entity.name 
    newRelic:
      select: average(cluster.nodes)
      from: ElasticsearchClusterSample
      eventId: entityGuid
      eventName: entityName
clusterActiveShard:
  title: Cluster Active Shard
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.shards)
      from: Metric
      where: metricName = 'elasticsearch.cluster.shards' AND state='active'
      eventId: entity.guid
      eventName: entity.name
clusterInitializingShard:
  title: Cluster Initializing Shard
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.shards)
      from: Metric
      where: metricName = 'elasticsearch.cluster.shards' AND state='initializing'
      eventId: entity.guid
      eventName: entity.name
clusterPrimaryActiveShard:
  title: Cluster Primary Active Shard
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.shards)
      from: Metric
      where: metricName = 'elasticsearch.cluster.shards' AND state='active_primary'
      eventId: entity.guid
      eventName: entity.name
clusterRelocatingShard:
  title: Cluster Relocating Shard
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.shards)
      from: Metric
      where: metricName = 'elasticsearch.cluster.shards' AND state='relocating'
      eventId: entity.guid
      eventName: entity.name
clusterUnassignedShard:
  title: Cluster Unassigned Shard
  queries:
    opentelemetry:
      select: average(elasticsearch.cluster.shards)
      from: Metric
      where: metricName = 'elasticsearch.cluster.shards' AND state='unassigned'
      eventId: entity.guid
      eventName: entity.name
    newRelic:
      select: average(shards.unassigned)
      from: ElasticsearchClusterSample
      eventId: entityGuid
      eventName: entityName
clusterPendingTask:
  title: Cluster Pending Tasks
  queries:
    opentelemetry:
      select: latest(elasticsearch.cluster.pending_tasks)
      from: Metric
      where: metricName = 'elasticsearch.cluster.pending_tasks'
      eventId: entity.guid
      eventName: entity.name      