
partitionsWithNonPreferredLeader:
  title: Partitions with non-preferred leader
  unit: COUNT
  queries:
    newRelic:
      select: average(topic.partitionsWithNonPreferredLeader)
      from: KafkaTopicSample
      eventId: entityGuid
      eventName: entityName
underReplicatedPartitions:
  queries:
    newRelic:
      select: average(topic.underReplicatedPartitions)
      from: KafkaTopicSample
      eventId: entityGuid
      eventName: entityName
    opentelemetry:
      select: (sum(kafka.partition.replicas) - sum(kafka.partition.replicas_in_sync))/uniqueCount(kafka.cluster.name), uniques(partition)
      from: Metric
      where: metricName IN ('kafka.partition.replicas', 'kafka.partition.replicas_in_sync')
      eventId: entity.guid
      eventName: entity.name
  unit: COUNT
  title: Under replicated partitions