domain: EXT
type: HOST
synthesis:
  rules:
    #telemetry from datadog agent
    - ruleName: ext_host_host_name
      identifier: host.name
      name: host.name
      encodeIdentifierInGUID: true
      conditions:
        - attribute: metricName
          prefix: datadog.system.

    # telemetry from generic flex agent
    - ruleName: ext_host_displayName
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: FlexSystemSample

     # telemetry from generic ansible agent
    - ruleName: ext_host_displayName_2
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleSystemSample

    # ansible agent requires same guid on other generated samples
    - ruleName: ext_host_displayName_3
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleNetstatSample
    - ruleName: ext_host_displayName_4
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleServiceSample
    - ruleName: ext_host_displayName_5
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleStorageSample 
    - ruleName: ext_host_displayName_6
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleDiskIOSample 
    - ruleName: ext_host_displayName_7
      identifier: displayName
      name: displayName
      encodeIdentifierInGUID: true
      conditions:
      - attribute: eventType
        value: AnsibleVmSystemSample 

  tags:
    localIp:
      multiValue: false
    shortHostname:
      multiValue: false
    arch:
      multiValue: false
    coreCount:
      multiValue: false
    threadsPerCore:
      multiValue: false
    distribution:
      multiValue: false
    distributionVersion:
      multiValue: false
    operatingSystem:
      multiValue: false
    virtualizationType:
      multiValue: false

dashboardTemplates:
  datadog:
    template: datadog-dashboard.json
  flexagent:
    template: flex-dashboard.json
    
configuration:
  entityExpirationTime: QUARTERLY
  alertable: false

ownership:
  primaryOwner:
    teamName: "no owner"
