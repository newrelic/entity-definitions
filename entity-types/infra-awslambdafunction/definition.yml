domain: INFRA
type: AWSLAMBDAFUNCTION
goldenTags:
- aws.awsRegion
- aws.region
- aws.accountId
- aws.memorySize
- aws.runtime
- aws.timeout
- aws.handler
- account
- label.Team
- label.team
- label.env
- label.environment
configuration:
  entityExpirationTime: DAILY
  alertable: true

synthesis:
  rules:
    # Legacy API Polling entities not using the ARN to compute the entity.guid, but directly providing the entityId
    - identifier: entityId
      name: entity.name
      encodeIdentifierInGUID: false
      conditions:
        - attribute: eventType
          value: Log
        - attribute: entity.type
          value: AWSLAMBDAFUNCTION
        - attribute: entityId
          present: true
      tags:
        # Used in AWSLAMBDAFUNCTION.yml for entity relationship candidates
        aws.Arn:
          entityTagNames: [ aws.arn ]
        aws.lambda.FunctionName:
          entityTagNames: [ entity.name ]
        displayName:
          entityTagNames: [ entity.name ]
        # These may not be present, but will be included if so
        aws.accountId:
        aws.region:
    # Metrics Streams and API Polling entities using the ARN to compute the entity.guid
    - identifier: aws.arn
      name: entity.name
      encodeIdentifierInGUID: true
      conditions:
        - attribute: eventType
          value: Log
        - attribute: entity.type
          value: AWSLAMBDAFUNCTION
        - attribute: entityId
          present: false
      tags:
        # Used in AWSLAMBDAFUNCTION.yml for entity relationship candidates
        aws.Arn:
          entityTagNames: [ aws.arn ]
        aws.lambda.FunctionName:
          entityTagNames: [ entity.name ]
        displayName:
          entityTagNames: [ entity.name ]
        # These may not be present, but will be included if so
        aws.accountId:
        aws.region: