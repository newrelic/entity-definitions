relationships:
  - name: awsEc2SecurityGroupSecuresVpcNetworkInterface
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSVPCNETWORKINTERFACE", "AWS_VPC_NETWORK_INTERFACE" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSVPCNETWORKINTERFACE

  - name: awsEc2SecurityGroupSecuresEbsVolume
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSEBSVOLUME", "AWS_EBS_VOLUME" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSEBSVOLUME

  - name: awsEc2SecurityGroupSecuresHost
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "HOST" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: HOST

  - name: awsEc2SecurityGroupSecuresVpc
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSEC2VPC", "AWS_EC2_VPC" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSEC2VPC

  - name: awsEc2SecurityGroupSecuresSecurityGroup
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSEC2SECURITYGROUP", "AWS_EC2_SECURITY_GROUP" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSEC2SECURITYGROUP

  - name: awsEc2SecurityGroupSecuresSubnet
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSEC2SUBNET", "AWS_EC2_SUBNET" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSEC2SUBNET

  - name: awsEc2SecurityGroupSecuresRdsDbInstance
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSRDSDBINSTANCE", "AWS_RDS_DB_INSTANCE" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSRDSDBINSTANCE

  - name: awsEc2SecurityGroupSecuresSnsTopicSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSSNSTOPIC", "AWS_SNS_TOPIC" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSSNSTOPIC

  - name: awsEc2SecurityGroupSecuresRdsDbCluster
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSRDSDBCLUSTER", "AWS_RDS_DB_CLUSTER" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSRDSDBCLUSTER

  - name: awsEc2SecurityGroupSecuresSqsQueueSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSSQSQUEUE", "AWS_SQS_QUEUE" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSSQSQUEUE

  - name: awsEc2SecurityGroupSecuresEcsTaskDefinitionSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSECSTASKDEFINITION", "AWS_ECS_TASK_DEFINITION" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSECSTASKDEFINITION

  - name: awsEc2SecurityGroupSecuresEcsClusterSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSECSCLUSTER", "AWS_ECS_CLUSTER" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSECSCLUSTER

  - name: awsEc2SecurityGroupSecuresLambdaFunctionSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSLAMBDAFUNCTION", "AWS_LAMBDA_FUNCTION" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSLAMBDAFUNCTION

  - name: awsEc2SecurityGroupSecuresRdsProxySecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSRDSPROXY", "AWS_RDS_PROXY" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSRDSPROXY

  - name: awsEc2SecurityGroupSecuresS3BucketSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSS3BUCKET", "AWS_S3_BUCKET" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSS3BUCKET

  - name: awsEc2SecurityGroupSecuresMskClusterSecures
    version: "1"
    origins:
      - AWS Integration
    conditions:
      - attribute: eventType
        anyOf: [ "Metric" ]
      - attribute: entity.type
        anyOf: [ "AWSMSKCLUSTER", "AWS_MSK_CLUSTER" ]
    relationship:
      expires: P75M
      relationshipType: SECURES
      source:
        lookupGuid:
          candidateCategory: AWSEC2SECURITYGROUP
          fields:
            - field: awsAccountId
              attribute: aws.accountId
            - field: awsRegion
              attribute: aws.region
      target:
        extractGuid:
          attribute: entity.guid
          entityType:
            value: AWSMSKCLUSTER
