relationships:
  - name: MemcachedInstanceContainsMemcachedSlab
    version: "1"
    origins:
      - OnHost Integration
    conditions:
      - attribute: eventType
        anyOf: [ "MemcachedSlabSample" ]
      - attribute: nr.entityType
        anyOf: [ "MEMCACHEDSLAB" ]
      - attribute: reportingEndpoint
        present: true
    relationship:
      expires: PT75M
      relationshipType: CONTAINS
      source:
        lookupGuid:
          candidateCategory: MEMCACHEDINSTANCE
          fields:
            - field: reportingEndpoint
              capture:
                attribute: reportingEndpoint
                regex: "(.*)"
      target:
        extractGuid:
          attribute: entityGuid
          entityType:
            attribute: nr.entityType

