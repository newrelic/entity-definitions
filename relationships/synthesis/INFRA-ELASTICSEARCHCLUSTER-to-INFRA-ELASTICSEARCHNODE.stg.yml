relationships:
  - name: infraElasticsearchClusterContainsNode
    version: "1"
    origins:
      - OnHost Integration
    conditions: 
      - attribute: eventType
        anyOf: [ "ElasticsearchNodeSample" ]
      - attribute: nr.entityType
        anyOf: ["ELASTICSEARCHNODE"]
      - attribute: entityKey
        regex: ".*:clustername=([^:]+)"
    relationship:
      expires: PT75M
      relationshipType: CONTAINS
      source:
        lookupGuid:
          candidateCategory: ELASTICSEARCHCLUSTER
          fields:
            - field: elasticsearchclustername
              capture:
                attribute: entityKey
                regex: ".*:clustername=([^:]+)"
      target:
        extractGuid:
          attribute: entityGuid
          entityType:
            value: ELASTICSEARCHNODE
