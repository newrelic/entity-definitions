category: EXTENVOY
lookups:
  - entityTypes:
    - domain: EXT
      type: ENVOY
    tags:
      matchingMode: ALL
      predicates:
        - tagKeys: ["k8s.clusterName"]
          field: cluster_name
        - tagKeys: ["k8s.namespaceName"]
          field: namespace
        - tagKeys: ["k8s.podName"]
          field: pod
    onMatch:
      onMultipleMatches: RELATE_ALL
    onMiss:
      action: NO_OP
  - entityTypes:
    - domain: EXT
      type: ENVOY
    tags:
      matchingMode: ALL
      predicates:
        - tagKeys: ["k8s.clusterName"]
          field: k8s.cluster.name
        - tagKeys: ["k8s.namespaceName"]
          field: k8s.namespace.name
        - tagKeys: ["k8s.podName"]
          field: k8s.pod.name  
    onMatch:
      onMultipleMatches: RELATE_ALL
    onMiss:
      action: NO_OP